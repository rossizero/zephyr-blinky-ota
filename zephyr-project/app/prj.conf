# Logging
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3

# Basic Networking
CONFIG_NETWORKING=y
CONFIG_NET_IPV4=y
CONFIG_NET_DHCPV4=y
CONFIG_NET_TCP=y
CONFIG_NET_SOCKETS=y

# WiFi
CONFIG_WIFI=y
CONFIG_WIFI_ESP32=y
CONFIG_NET_L2_WIFI_MGMT=y
CONFIG_NET_MGMT=y
CONFIG_NET_MGMT_EVENT=y

# System
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_HEAP_MEM_POOL_SIZE=65536

# GPIO
CONFIG_GPIO=y

# ESP32 Flash
CONFIG_ESPTOOLPY_FLASHMODE_QIO=y
CONFIG_ESPTOOLPY_FLASHFREQ_80M=y
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=y

# Network Buffer
CONFIG_NET_BUF_RX_COUNT=16
CONFIG_NET_BUF_TX_COUNT=16

# Shell aktivieren (benötigt für MCUBOOT_SHELL)
CONFIG_SHELL=y
CONFIG_SHELL_BACKENDS=y
CONFIG_SHELL_BACKEND_SERIAL=y

# =====================================================================
# --- THIS IS THE ONLY MCUBOOT CONFIGURATION NEEDED IN THIS FILE ---
# =====================================================================

# This single option tells the build system EVERYTHING it needs to know:
# 1. This application is managed by MCUboot.
# 2. It should enable the C APIs (like img_manager).
# 3. It should trigger the signing process.
# 4. Because a `child_image/mcuboot.conf` exists, it will automatically
#    trigger the child image build.
CONFIG_BOOTLOADER_MCUBOOT=y

# This tells the signing script which key to use for the application.
CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=n
CONFIG_MCUBOOT_SIGNATURE_KEY_FILE="C:/Users/SebastianR/Documents/zephyr-keys/root-rsa-2048.pem"

CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_STREAM_FLASH=y
CONFIG_IMG_MANAGER=y
CONFIG_MCUBOOT_SHELL=y

# Flash write protection
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y

# HTTP client for OTA downloads
CONFIG_HTTP_CLIENT=y
#CONFIG_HTTP_CLIENT_STACK_SIZE=4096

# JSON parsing for version checks
CONFIG_JSON_LIBRARY=y

# Watchdog for recovery
CONFIG_WATCHDOG=y

CONFIG_REBOOT=y
CONFIG_USE_DT_CODE_PARTITION=y